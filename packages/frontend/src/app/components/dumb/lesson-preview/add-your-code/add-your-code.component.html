<section class="add-your-code">
  @if (isStepWithImage) {
    <!-- StepWithImage[]: step -> image -> step -> image -->
    <!-- This is normally for scratch lessons -->
    @for (step of stepsWithImages; track $index; let i = $index) {
      @let splitText = step.step.split(':');
      @if (splitText.length == 2) {
        <p class="step" style="font-weight: bold">
          <span>({{ i + 1 }}) {{ splitText[0].toUpperCase() }}:</span>
          <span style="font-weight: normal">{{ splitText[1] }}</span>
        </p>
      } @else {
        <p class="step">({{ i + 1 }}) {{ step.step }}</p>
      }

      @if (step.imageSlot && step.imageSlot.base64) {
        <img class="step-image" [src]="step.imageSlot.base64" />
        <br />
      }
    }
  } @else if (isStepsWithCodeBlockArray) {
    <!-- StepsWithCodeBlock[]: steps list -> code block -> steps list -> code block -> ... -->
    <!-- Programming language lessons use this format -->
    @if (stepsWithCodeBlockArray.length > 1) {
      @for (part of stepsWithCodeBlockArray; track $index; let i = $index) {
        <div class="multiple-steps-with-code-block">
          @for (step of part.steps; track $index) {
            <p class="step">({{ i + 1 }}) {{ step }}</p>
          }
          @if (part.codeBlock?.trim()) {
            <pre class="code-block"><code
            prismHighlight
            [code]="part.codeBlock"
            [language]="programmingLanguage"
          ></code></pre>
          }
        </div>
      }
    } @else {
      <!-- Sometimes a lesson may have one code block with multiple steps before it -->
      <!-- We handle this here -->
      <div class="multiple-steps-with-code-block">
        @for (step of stepsWithCodeBlockArray[0].steps; track $index; let i = $index) {
          <p class="step">({{ i + 1 }}) {{ step }}</p>
        }
        @if (stepsWithCodeBlockArray[0].codeBlock?.trim()) {
          <pre class="code-block"><code
            prismHighlight
            [code]="stepsWithCodeBlockArray[0].codeBlock"
            [language]="programmingLanguage"
          ></code></pre>
        }
      </div>
    }
  }
</section>
