@if (data) {
  <div #sourceContent style="display: none">
    <!-- Repeats on every page, this is the header with logo and language logo -->
    <header class="lesson-preview-header">
      <span class="header-logo">
        <img class="lesson-logo" src="digimaker-logo.png" width="200px" />
      </span>
      <span class="header-badges">
        @if (languageBadgeSrc) {
          <img class="language-badge" [src]="languageBadgeSrc" [alt]="languageBadgeAlt" />
        }
        @if (levelBadgeSrc) {
          <img class="level-badge" [src]="levelBadgeSrc" alt="Level" />
        }
      </span>
    </header>

    <main>
      <app-title-section
        [topic]="data.topic"
        [project]="data.project"
        [description]="data.description"
      />

      @if (data.lessonType !== 'debugging lesson' && data.projectExplainer.trim()) {
        <section class="oneliner">
          <p>{{ data.projectExplainer }}</p>
        </section>
      }

      <!-- Multiple preface images -->
      @if (data.prefaceImageSlots && data.prefaceImageSlots.length > 1) {
        <div class="preface-images">
          @for (slot of data.prefaceImageSlots; track $index) {
            <img class="preface-image" [src]="slot.base64" />
          }
        </div>
      }

      <h3 class="get-ready-header">Get Ready</h3>
      <app-get-ready-section
        [getReadySectionData]="data.getReadySection"
        [imageSlot]="data.prefaceImageSlots?.length == 1 ? data.prefaceImageSlots![0] : null"
      />

      @if (data.lessonType === 'debugging lesson') {
        <app-debug-section [debugSteps]="data.debugSection" />
      } @else {
        <app-add-your-code
          [data]="data.addYourCodeSection"
          [programmingLanguage]="data.programmingLanguage"
        />

        <app-try-it-out [tryItOutData]="data.tryItOutSection!" />

        @if (data.challengeSection) {
          <app-challenge-section
            [challenges]="data.challengeSection"
            [programmingLanguage]="data.programmingLanguage"
          />
        }

        @if (data.newProject) {
          <app-new-project-section [newProject]="data.newProject" />
        }

        @if (data.testYourself) {
          <app-test-yourself [testYourselfData]="data.testYourself" />
        }

        @if (data.funFact) {
          <app-fun-fact [funFact]="data.funFact" />
        }
      }
    </main>
  </div>
}

<div #previewContainer class="pdf-preview"></div>
