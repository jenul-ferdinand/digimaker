@if (data) {
  <div #sourceContent style="display: none">
    <!-- Repeats on every page, this is the header with logo and language logo -->
    <header class="lesson-preview-header">
      <span class="header-logo">
        <img class="lesson-logo" src="digimaker-logo.png" width="200px" />
      </span>
    </header>

    <main>
      <div class="preface-section">
        <app-title-section
          [topic]="data.topic"
          [project]="data.project"
          [description]="data.description"
        />

        <div class="details-section">
          @if (data.lessonType !== 'debugging lesson' && data.projectExplainer.trim()) {
            <section class="oneliner">
              <p class="project-title">
                Project this week:
                <span style="font-family: 'Poppins'; font-weight: normal">{{ data.project }}</span>
              </p>
              <p>{{ data.projectExplainer }}</p>
            </section>
          }

          <!-- Multiple preface images -->
          @if (data.prefaceImageSlots) {
            <div class="preface-images">
              @for (slot of data.prefaceImageSlots; track $index) {
                <img class="preface-image" [src]="slot.base64" />
              }
            </div>
          }
        </div>

        <!-- Language and level -->
        <div class="preface-language-badge">
          @if (data.programmingLanguage === 'scratch' || data.programmingLanguage === 'pygame') {
            <!-- Wide logos need larger width -->
            <img class="preface-language-badge-icon" style="width: 32mm" [src]="languageBadgeSrc" />
          } @else {
            <img class="preface-language-badge-icon" [src]="languageBadgeSrc" />
          }
          <div class="details">
            <p>Language: {{ languageMap[data.programmingLanguage] }}</p>
            <p>Level: {{ data.level }}</p>
          </div>
        </div>
      </div>

      <app-get-ready-section [getReadySectionData]="data.getReadySection" />

      @if (data.lessonType === 'debugging lesson') {
        <app-debug-section [debugSteps]="data.debugSection" />
      } @else {
        <app-add-your-code
          [data]="data.addYourCodeSection"
          [programmingLanguage]="data.programmingLanguage"
        />

        <app-try-it-out [tryItOutData]="data.tryItOutSection!" />

        @if (data.challengeSection) {
          <app-challenge-section
            [challenges]="data.challengeSection"
            [programmingLanguage]="data.programmingLanguage"
          />
        }

        @if (data.newProject) {
          <app-new-project-section [newProject]="data.newProject" />
        }

        @if (data.testYourself) {
          <app-test-yourself [testYourselfData]="data.testYourself" />
        }

        @if (data.funFact) {
          <app-fun-fact [funFact]="data.funFact" />
        }
      }
    </main>
  </div>
}

<div #previewContainer class="pdf-preview"></div>
